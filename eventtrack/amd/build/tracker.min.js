define ("block_eventtrack/tracker",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.postData=l;a.createTrackingEvent=m;a.init=function(a,b,c,d){K=b;I=c;J=d;L=a;n();o(a);v(a);s(a);w(a);u(a);p(a);q(a);z(a);U(a);y(a);A(a);B(a);E(a);D(a);F(a);r(a);C(a);G(a)};function b(a){return f(a)||e(a)||d(a)||c()}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(a,b){if(!a)return;if("string"==typeof a)return g(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return g(a,b)}function e(a){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a))return Array.from(a)}function f(a){if(Array.isArray(a))return g(a)}function g(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}function h(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);if(b)d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable});c.push.apply(c,d)}return c}function j(a){for(var b=1,c;b<arguments.length;b++){c=null!=arguments[b]?arguments[b]:{};if(b%2){h(Object(c),!0).forEach(function(b){k(a,b,c[b])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(a,Object.getOwnPropertyDescriptors(c))}else{h(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}}return a}function k(a,b,c){if(b in a){Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0})}else{a[b]=c}return a}var H=[.2,.4,.6,.8,1],I="user",J="user",K="https://tracking.difa.edutec.science/datums",L="";function l(a){var b=fetch(K,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Basic "+window.btoa("".concat(I,":").concat(J))},body:JSON.stringify(a)}).then(function(a){return a}).catch(function(a){return console.log(a)});return b}function m(a,b){return{name:a,timestamp:M(),payload:j({url:window.location.href,userid:L,tabid:O()},b)}}var M=function(){return Date.now()},N=function(a){return a.id?a.id:null},O=function(){return window.tabId};function n(){if(sessionStorage.tabId&&"2"!==sessionStorage.closedLastTab){window.tabId=sessionStorage.tabId}else{sessionStorage.tabId=Math.floor(1e9*Math.random());window.tabId=sessionStorage.tabId}sessionStorage.closedLastTab="2";window.addEventListener("unload beforeunload",function(){sessionStorage.closedLastTab="1"})}function o(){var a=navigator.userAgent;l(m("useragent",{userAgent:a}))}function p(){document.body.addEventListener("mouseleave",function mouseLeave(){l(m("mouseleave",{}))})}function q(){document.body.addEventListener("mouseenter",function mouseEnter(){l(m("mouseenter",{}))})}function r(){document.body.addEventListener("contextmenu",function contextMenu(){l(m("contextmenu",{}))})}function s(){document.onclick=function(a){var b=a.target.href?a.target.href:null;if(!b){var d=a.target.closest("a");if(d){b=d.href}}var c=j({},t(a.target),{id:N(a.target),elementClasses:a.target.classList,nodeName:a.target.nodeName,href:b});l(m("click",c))}}function t(a){var b={topic:null,category:null,resource:null};if(a.dataset.topic){b.topic=a.dataset.topic}if(a.dataset.category){b.category=a.dataset.category}if(a.dataset.resource){b.resource=a.dataset.resource}return b}function u(){window.addEventListener("mouseup",function mouseUp(a){var b=window.getSelection().toString();if(b.length){var c={text:b,element:j({},t(a.target),{classes:a.target.classList,id:N(a.target),name:a.target.nodeName})};l(m("textselection",c))}})}function v(){var a=!0,b=function(b){if(!a){return}b.forEach(function(a){if(a.isIntersecting){var b=j({intersectionRatio:a.intersectionRatio,isIntersecting:a.isIntersecting,boundingClientRect:a.boundingClientRect,intersectionRect:a.intersectionRect,id:N(a.target)},t(a.target));l(m("intersection",b))}});a=!1;setTimeout(function(){a=!0},500)},c=new IntersectionObserver(b,{rootMargin:"0px",threshold:H});T().forEach(function(a){return c.observe(a)})}function w(){var a=null,b=0,c=[];document.onmousemove=function(d){var e=Date.now();if(e-b>=50){c.push({timestamp:e,x:d.pageX,y:d.pageY});b=e}if(!a){a=setTimeout(function(){var b={positions:c};l(m("mousemove",b));c=[];a=null},2e3)}}}var P=function(){return document.querySelectorAll("[data-category='paragraph']")},Q=function(){return document.querySelectorAll(".feedback")},R=function(){return document.querySelectorAll("[data-category='bibliography']")},S=function(){return document.querySelectorAll("audio, video")},T=function(){return[].concat(b(P()),b(Q()),b(R()),b(S()))};function x(){for(var a=T(),b=[],c=0,d;c<a.length;c++){d=a[c].getBoundingClientRect();b.push(j({},t(a[c]),{id:N(a[c]),y:d.top+window.scrollY,x:d.left+window.scrollX,w:a[c].offsetWidth,h:a[c].offsetHeight}))}if(0<b.length){l(m("positions",{paragraphs:b}))}}var U=function(){var a={viewport:{y:window.scrollY,x:window.scrollX,w:window.innerWidth,h:window.innerHeight}};l(m("viewport",a))};function y(){x();U();var a=null;window.addEventListener("resize",function(){clearTimeout(a);a=setTimeout(function(){x();U()},333)});var b=null;window.addEventListener("scroll",function(){if(!b){b=setTimeout(function(){U();b=null},333)}})}function z(){document.addEventListener("copy",function(a){var b=window.getSelection(),c={selection:b.toString(),element:{classes:a.target.classList,id:N(a.target),name:a.target.nodeName}};l(m("copy",c))})}function A(){window.addEventListener("blur",function(){l(m("blur",{}))})}function B(){window.addEventListener("focus",function(){l(m("focus",{}))})}function C(){var a=function(){x();U()},b=document.getElementById("region-main");if(b){new ResizeObserver(a).observe(document.getElementById("region-main"))}}function D(){var a=document.querySelectorAll("details");if(a){a.forEach(function(a){a.addEventListener("toggle",function(a){var b=j({open:a.target.open,id:a.target.id},t(a.target));l(m("detailsToggle",b));setTimeout(function(){return x()},100)})})}}function E(a){var c=b(document.querySelectorAll("input[type='checkbox']","input[type='radio']"));c.forEach(function(b){b.addEventListener("change",function(b){var c=b.target.parentNode.querySelector("[data-category='quiz-answer']"),d="";if(c){d=c.id}else{d=b.target.id}var e=j({quizInputId:b.target.id,checked:b.target.checked,id:d},t(c));l(m(a,"quizInputChange",e))})})}function F(){window.addEventListener("beforeunload",function(){l(m("unload",{}))})}function G(){document.querySelectorAll("audio, video").forEach(function(a){var b=function(a){return{currentTime:a.currentTime,src:a.currentSrc,duration:a.duration,paused:a.paused,volume:a.volume}};a.addEventListener("play",function(a){var c=b(a.target);l(m("mediaPlay",c))});a.addEventListener("pause",function(a){var c=b(a.target);l(m("mediaPause",c))});a.addEventListener("volumechange",function(a){var c=b(a.target);l(m("mediaVolumeChange",c))});a.addEventListener("ended",function(a){var c=b(a.target);l(m("mediaEnded",c))});a.addEventListener("interrupted",function(a){var c=b(a.target);l(m("mediaInterrupted",c))});a.addEventListener("seeked",function(a){var c=b(a.target);l(m("mediaSeeked",c))});a.addEventListener("ratechange",function(a){var c=b(a.target);l(m("mediaRateChange",c))});document.addEventListener("webkitfullscreenchange mozfullscreenchange fullscreenchange",function(a){var c=b(a.target);l(m("mediaFullscreenChange",c))});a.addEventListener("error, stalled",function(a){var c=b(a.target);l(m("mediaError",c))})})}});
//# sourceMappingURL=tracker.min.js.map
